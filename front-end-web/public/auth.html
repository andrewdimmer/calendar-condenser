<!DOCTYPE html>
<!-- NOTE: This page just saves the token as a cookie. -->
<!-- TODO: Introduce State Security -->
<html>
  <script>
    const url = window.location.href;
    const codeStartIndex = url.indexOf("?code=") + 6;
    const codeStopIndex = url.indexOf("&scope=");
    console.log(url);
    if (codeStartIndex > 0 && codeStopIndex > 0) {
      const date = new Date();
      date.setDate(date.getDate() + 1);
      const code = url.substring(codeStartIndex, codeStopIndex);
      document.cookie = `oauth=${code}; expires=${date.toString()}`;
      console.log(code);
    }
    window.open("../", "_self");
  </script>
</html>

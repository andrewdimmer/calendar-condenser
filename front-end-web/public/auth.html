<!DOCTYPE html>
<!-- NOTE: This page just saves the token as a cookie. -->
<!-- TODO: Introduce State Security -->
<html>
  <script>
    const url = window.location.href;
    const tokenStartIndex = url.indexOf("?code=") + 6;
    const tokenStopIndex = url.indexOf("&scope=");
    console.log(url);
    if (tokenStartIndex > 0 && tokenStopIndex > 0) {
      const token = url.substring(tokenStartIndex, tokenStopIndex);
      const currentDate = new Date();
      const expireDate = currentDate.setDate(currentDate.getDate() + 1);
      document.cookie = `userToken=${token}; expires=${expireDate.toLocaleString}`;
      console.log(token);
    }
    setTimeout(() => {
      window.open("../", "_self");
    }, 3000);
  </script>
</html>
